CREATE TABLE `lottery_action` (
  `id` int(3) unsigned NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `uid` varchar(50) NOT NULL COMMENT 'uid',
  `username` varchar(50) NOT NULL COMMENT '用户名',
  `result`   varchar(70)  NOT NULL DEFAULT '' COMMENT '中奖码',
  `message`  varchar(70)  NOT NULL DEFAULT '' COMMENT '具体信息',
  `time`  int  NOT NULL DEFAULT '0' COMMENT '抽奖时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8 COMMENT='行为表';

CREATE TABLE `lottery_jp` (
  `id` int(3) unsigned NOT NULL AUTO_INCREMENT COMMENT 'ID',
  PRIMARY KEY (`id`)  `num`  int NOT NULL COMMENT '奖品数目',
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='奖品数目表';

1. get_current_user()
2. pay_jhb(value)
3. check_user_login()
4. check_session_avaliable()

API: 
1. api.php?action=slot
       &index=0 // 如果是第一次抽奖则0，此时需要扣 10 JHB, 三次抽奖是一组。 如果三次抽奖结果一样说明中奖。
    
返回值：
    jsonp({index: 2}) // 返回当前抽中的号码索引。(暂时定为0-6共 7个奖品。)
其它错误情况返回:
     jsonp({message: }) 

     对了，每个人的每次抽奖都必须记录，
ベ終结者  22:31:06
嗯..要存在张表里

点一下遥感，  传递 index=0,   开始扣费
然后 再点3次， index=1,2,3   
然后报告结果

一次完整的抽奖，会请求后台4次， index 分别是次数。你要在第 0 次就生成它是否中奖的结果
js会让用户以为是它自己控制 的结果。。
徐琳迪  22:33:44
这样，用户没中奖 只能 怪自己没水平。。。后台必须隐蔽。。
ベ終结者  22:35:37
这个概率 后台控制
徐琳迪  22:35:43
对的，
徐琳迪  22:40:15
你可以考虑一个用户的抽奖时间和总JHB数来稍微影响下概率
ベ終结者  22:40:56
嗯，了解了....我要先去看DZ 2.5的表和代码先... 对这个还不是很了解..
徐琳迪  22:41:33
不用你自己操作的，论坛有api的
这个和dz也没关系，走的是个人中心
ベ終结者  22:44:31
用户中心吗？我得去看看
徐琳迪  22:44:51
怎么方便怎么来，做出来就行
ベ終结者  22:44:51
好的，有现成的API就好
嗯，好的
徐琳迪  22:45:03
论坛肯定有现成api的
ベ終结者  22:46:32
我先找找先
徐琳迪  22:52:13
为了减少服务器压力，暂时先只请求 index=0的那次好了
徐琳迪 0:31:40 

界面好了 

徐琳迪 0:36:35 

参数： 无

返回： {result: 中奖码, message: 中奖信息} 

徐琳迪 0:37:02 

中奖码 >=0  是奖品序号

< 0 是没中奖 

徐琳迪 1:06:43 

搞好了，你填吧 

郑洋飞 1:06:57 

.. 来了 

郑洋飞 1:07:04 

点错了 

郑洋飞 1:07:05 

汗 

徐琳迪 1:07:16 

嗯，你可以打开页面，看页面请求的接口就ok 

郑洋飞 1:07:34 

ok 

郑洋飞 1:07:38 

木有问题 

徐琳迪 1:07:53 

输入无，输出



/

{result: 中奖码, message: 中奖信息}

 

1:08:33

成功接收离线文件“choujiang.rar”(339.00KB) 

 

打开文件  打开所在文件夹 

    

 

郑洋飞 1:09:39 

接口我先记录下来 

徐琳迪 1:09:53 

接下来还要做的事情： 

徐琳迪 1:10:12 

1. 让冯李丹提供礼品的图片， 分别放在 slot  

徐琳迪 1:10:23 

2. 一定要先内部测试 

郑洋飞 1:10:49 

懂了 

徐琳迪 1:10:54 

如果你想先玩玩 

徐琳迪 1:11:02 

在控制台可以执行  DEBUG=1 

郑洋飞 1:11:57 

嗯，调试模式 

徐琳迪 1:12:08 

效果应该是不错的吧 

郑洋飞 1:12:37 

嗯 

郑洋飞 1:17:14 

bugu 

郑洋飞 1:17:14 

o 

徐琳迪 1:17:26 

什么不够 

郑洋飞 1:17:29 

这个choujiang.js   汗 

徐琳迪 1:18:45 

快检查下 

徐琳迪 1:18:54 

明天我就回去了，回去没网 

郑洋飞 1:19:18 

满眼都是XLD 

徐琳迪 1:19:31 

这不是很好么       

郑洋飞 1:22:00 

额...  看的我眼都花了，我咋找 接口啊 

徐琳迪 1:22:23 

接口就1个，我告诉你了。。 

郑洋飞 1:22:24 

你不会是写完 然后替换掉成XLD的吧...0.0.. 

徐琳迪 1:22:41 

请求：   api.php 

徐琳迪 1:22:48 

没有任何参数。。 

郑洋飞 1:24:17 

嗯..了解了 

徐琳迪 1:24:36 

或者，你点下那个网页，就知道有请求发出了 

郑洋飞 1:25:11 

console里看到了  

徐琳迪 1:25:28 

 嗯 

徐琳迪 1:34:50 

不小心2个一样了。。 

徐琳迪 1:34:57 

注意，，草莓一样。。不是bug 

郑洋飞 1:35:35 

哦 ..我换一个图标好了 

徐琳迪 1:35:39 

嗯 

徐琳迪 1:35:43 

要透明png 

徐琳迪 1:35:51 

奖品数目可以随便设 

郑洋飞 1:36:04 

懂了  

徐琳迪 1:36:11 

上线的时候要换成真实奖品的 

郑洋飞 1:36:19 

嗯 

